input_file_ModelData = input_file_ModelData,
input_file_FMIData = input_file_FMIData,
input_file_SpendData = input_file_SpendData,
input_file_MSRPData = input_file_MSRPData
)
mod_obj <- create_mod_obj()
mod_obj <- mod_obj %>%
activate_model_setup(input_file_ModelSetup) %>%
activate_model_spec(input_file_ModelSpec) %>%
add_group_selector(vehicles = nmp, regions = rgn) %>%
Load_Data(input_files)
is.transform_ready(mod_obj)
input_FitCurves <- here::here("data","Fit_Curves.xlsx")
mod_obj <- Load_FitCurves(mod_obj, input_FitCurves)
is.transform_ready(mod_obj)
?sym
?bind_cols
?one_of
?pivot_longer
?ends_with
?unite
?imap
?as_tibble
?bind_rows
?separate
?summarise
?everything
?left_join
?arrange
?rename
styler:::style_active_file()
devtools::document()
devtools::document()
library(mmmactive)
devtools::document()
?read.csv
?spread
devtools::document()
?set_names
?‘:=’
??‘:=’
??`:=`
library(mmmactive)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
library(mmmactive)
mod_obj <- create_mod_obj()
mod_obj
is.mod_obj(mod_obj)
is.activated(mod_obj)
is.load_data_ready(mod_obj)
is.data_transformed(mod_obj)
is.modeled(mod_obj)
input_file_ModelSetup =  here::here("data","ttn-ModelSetup.csv")
mod_obj <- activate_model_setup(mod_obj, input_file_ModelSetup)
names(mod_obj)
is.activated(mod_obj)
input_file_ModelSpec = here::here("data","ttn-ModelSpec.csv")
mod_obj <- activate_model_spec(mod_obj, input_file_ModelSpec)
names(mod_obj)
is.activated(mod_obj)
is.load_data_ready(mod_obj)
rgn <- c("CR", "MAR", "MTN", "MWR", "NER", "NWR", "SER", "WR")
mod_obj <- add_group_selector(mod_obj, vehicles = mod_obj$nmp, regions = rgn)
mod_obj$data_group_selector
is.load_data_ready(mod_obj)
mod_obj$spec
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
#library(tidyverse)
library(mmmactive)
input_file_ModelSetup =  here::here("data","ttn-ModelSetup.csv")
input_file_ModelSpec = here::here("data","ttn-ModelSpec.csv")
nmp <- "ttn"
rgn <- c("CR", "MAR", "MTN", "MWR", "NER", "NWR", "SER", "WR")
mod_obj <- create_mod_obj()
mod_obj <- mod_obj %>%
activate_model_setup(input_file_ModelSetup) %>%
activate_model_spec(input_file_ModelSpec)
mod_obj <- add_group_selector(mod_obj, vehicles = nmp, regions = rgn)
input_file_ModelData = here::here("data","ModelData.xlsx")
mod_obj <- Load_ModelData(mod_obj, input_file_ModelData)
glimpse(mod_obj$data_input$monthly)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
#library(tidyverse)
library(mmmactive)
#library(tidyverse)
library(mmmactive)
input_file_ModelSetup =  here::here("data","ttn-ModelSetup.csv")
input_file_ModelSpec = here::here("data","ttn-ModelSpec.csv")
nmp <- "ttn"
rgn <- c("CR", "MAR", "MTN", "MWR", "NER", "NWR", "SER", "WR")
mod_obj <- create_mod_obj()
mod_obj <- mod_obj %>%
activate_model_setup(input_file_ModelSetup) %>%
activate_model_spec(input_file_ModelSpec)
#library(tidyverse)
library(mmmactive)
input_file_ModelSetup =  here::here("data","ttn-ModelSetup.csv")
input_file_ModelSpec = here::here("data","ttn-ModelSpec.csv")
nmp <- "ttn"
rgn <- c("CR", "MAR", "MTN", "MWR", "NER", "NWR", "SER", "WR")
mod_obj <- create_mod_obj()
mod_obj <- mod_obj %>%
mod_obj <- activate_model_setup(mod_obj, input_file_ModelSetup)
#library(tidyverse)
library(mmmactive)
input_file_ModelSetup =  here::here("data","ttn-ModelSetup.csv")
input_file_ModelSpec = here::here("data","ttn-ModelSpec.csv")
nmp <- "ttn"
rgn <- c("CR", "MAR", "MTN", "MWR", "NER", "NWR", "SER", "WR")
mod_obj <- create_mod_obj()
mod_obj <- mod_obj
mod_obj <- activate_model_setup(mod_obj, input_file_ModelSetup)
mod_obj <- activate_model_spec(mod_obj, input_file_ModelSpec)
?cols
library(mmmactive)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
#library(tidyverse)
library(mmmactive)
input_file_ModelSetup =  here::here("data","ttn-ModelSetup.csv")
input_file_ModelSpec = here::here("data","ttn-ModelSpec.csv")
nmp <- "ttn"
rgn <- c("CR", "MAR", "MTN", "MWR", "NER", "NWR", "SER", "WR")
mod_obj <- create_mod_obj()
mod_obj <- mod_obj
mod_obj <- activate_model_setup(mod_obj, input_file_ModelSetup)
mod_obj <- activate_model_spec(mod_obj, input_file_ModelSpec)
mod_obj <- add_group_selector(mod_obj, vehicles = nmp, regions = rgn)
input_file_ModelData = here::here("data","ModelData.xlsx")
mod_obj <- Load_ModelData(mod_obj, input_file_ModelData)
glimpse(mod_obj$data_input$monthly)
str(mod_obj$data_input$monthly)
?str
str(mod_obj$data_input$monthly, max.level = 1)
str(mod_obj$data_input$monthly, max.level = 2)
str(mod_obj$data_input$monthly, max.level = 2)
str(mod_obj$data_input$weekly, max.level = 2)
str(mod_obj$Ftable, max.level = 2)
str(mod_obj$Ftable)
input_file_FMIData = here::here("data","FMI.csv")
mod_obj <- Load_FMIData(mod_obj, input_file_FMIData)
str(mod_obj$Ftable)
input_file_MSRPData <- here::here("data","MSRPData.csv")
mod_obj <- Load_MSRPData(mod_obj, input_file_MSRPData)
mod_obj$Mtable
input_file_SpendData <- here::here("data","SpendData.csv")
mod_obj <- Load_SpendData(mod_obj, input_file_SpendData)
mod_obj$Stable
input_files = list(
input_file_ModelData = input_file_ModelData,
input_file_FMIData = input_file_FMIData,
input_file_SpendData = input_file_SpendData,
input_file_MSRPData = input_file_MSRPData
)
mod_obj <- Load_Data(mod_obj, input_files)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
library(mmmactive)
nmp <- "ttn"
rgn <- c("CR", "MAR", "MTN", "MWR", "NER", "NWR", "SER", "WR")
input_file_ModelSetup =  here::here("data","ttn-ModelSetup.csv")
input_file_ModelSpec = here::here("data","ttn-ModelSpec.csv")
input_file_ModelData = here::here("data","ModelData.xlsx")
input_file_FMIData = here::here("data","FMI.csv")
input_file_MSRPData <- here::here("data","MSRPData.csv")
input_file_SpendData <- here::here("data","SpendData.csv")
input_files = list(
input_file_ModelData = input_file_ModelData,
input_file_FMIData = input_file_FMIData,
input_file_SpendData = input_file_SpendData,
input_file_MSRPData = input_file_MSRPData
)
mod_obj <- create_mod_obj()
mod_obj <- mod_obj %>%
activate_model_setup(input_file_ModelSetup) %>%
activate_model_spec(input_file_ModelSpec) %>%
add_group_selector(vehicles = nmp, regions = rgn) %>%
Load_Data(input_files)
library(mmmactive)
nmp <- "ttn"
rgn <- c("CR", "MAR", "MTN", "MWR", "NER", "NWR", "SER", "WR")
input_file_ModelSetup =  here::here("data","ttn-ModelSetup.csv")
input_file_ModelSpec = here::here("data","ttn-ModelSpec.csv")
input_file_ModelData = here::here("data","ModelData.xlsx")
input_file_FMIData = here::here("data","FMI.csv")
input_file_MSRPData <- here::here("data","MSRPData.csv")
input_file_SpendData <- here::here("data","SpendData.csv")
input_files = list(
input_file_ModelData = input_file_ModelData,
input_file_FMIData = input_file_FMIData,
input_file_SpendData = input_file_SpendData,
input_file_MSRPData = input_file_MSRPData
)
mod_obj <- create_mod_obj()
mod_obj <- activate_model_setup(mod_obj, input_file_ModelSetup)
mod_obj <- activate_model_spec(mod_obj, input_file_ModelSpec)
mod_obj <- add_group_selector(mod_obj, vehicles = nmp, regions = rgn)
mod_obj <- Load_Data(mod_obj, input_files)
is.transform_ready(mod_obj)
input_FitCurves <- here::here("data","Fit_Curves.xlsx")
mod_obj <- Load_FitCurves(mod_obj, input_FitCurves)
is.transform_ready(mod_obj)
mod_obj <- Transform(mod_obj, print = FALSE)
str(mod_obj$data_transformed$monthly)
str(mod_obj$data_transformed$monthly, max.level = 2)
str(mod_obj$data_transformed$weekly)
str(mod_obj$data_transformed$weekly, max.level = 2)
str(mod_obj$data, max.level = 2)
mod_obj <- Transform(mod_obj)
data_vector = mod_obj$data_input$weekly[["tv_e_eeq_direct_t2"]]
transfromation_instruction = mod_obj$spec[mod_obj$spec$Orig_Variable == "tv_e_eeq_direct_t2",]
as.data.frame(transfromation_instruction)
data_vector_transformed =
TransformVar(data_vector = data_vector,
spec_row = transfromation_instruction,
fit_curves = mod_obj$fit_curves)
plot(data_vector, data_vector_transformed)
data_vector = 1:200
transfromation_instruction = mod_obj$spec[mod_obj$spec$Orig_Variable == "tv_e_eeq_direct_t2",]
data_vector_transformed =
TransformVar(data_vector = data_vector,
spec_row = transfromation_instruction,
fit_curves = mod_obj$fit_curves,
print = FALSE)
plot(data_vector, data_vector_transformed)
library(mmmactive)
devtools::document()
library(reshape2)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
#library(tidyverse)
library(mmmactive)
input_file_ModelSetup =  here::here("data","ttn-ModelSetup.csv")
input_file_ModelSpec = here::here("data","ttn-ModelSpec.csv")
nmp <- "ttn"
rgn <- c("CR", "MAR", "MTN", "MWR", "NER", "NWR", "SER", "WR")
mod_obj <- create_mod_obj()
mod_obj <- mod_obj
mod_obj <- activate_model_setup(mod_obj, input_file_ModelSetup)
mod_obj <- activate_model_spec(mod_obj, input_file_ModelSpec)
mod_obj <- add_group_selector(mod_obj, vehicles = nmp, regions = rgn)
input_file_ModelData = here::here("data","ModelData.xlsx")
mod_obj <- Load_ModelData(mod_obj, input_file_ModelData)
input_file_FMIData = here::here("data","FMI.csv")
input_file_FMIData
FMI <-
read.csv(input_file_FMIData, stringsAsFactors = FALSE) %>%
dplyr::collect(n = Inf) %>%
dplyr::filter(region == "100") %>%
dplyr::filter(vehicle %in% c(
"alt", "arm", "fro", "lef", "max", "mur",
"nv", "pth", "rge", "sen", "ttn", "ver"
)) %>%
dplyr::mutate(week = ymd(week))
FMI
Ftable <-
reshape2::dcast(FMI, vehicle + week ~ var + type + tier,
value.var = "value",
fun.aggregate = sum
) %>% as.data.frame(.)
Ftable
head(Ftable)
FMI
?pivot_wider
FMI %>% pivot_wider(-c(vehicle, week), names_from = c(var, type, tier), values_from = value)
FMI
FMI %>% pivot_wider(-c(vehicle, week), names_from = c(var, type, tier), values_from = value)
FMI %>% select(vehicle, week, var, type, tier, value) %>%
pivot_wider(-c(vehicle, week), names_from = c(var, type, tier), values_from = value)
FMI %>% select(vehicle, week, var, type, tier, value) %>%
pivot_wider(names_from = c(var, type, tier), values_from = value)
FMI %>% select(vehicle, week, var, type, tier, value) %>%
pivot_wider(names_from = c(var, type, tier), values_from = value, values_fn = sum)
Ftable2 <- FMI %>%
select(vehicle, week, var, type, tier, value) %>%
pivot_wider(names_from = c(var, type, tier), values_from = value, values_fn = sum) %>%
as.data.frame()
Ftable <-
reshape2::dcast(FMI, vehicle + week ~ var + type + tier,
value.var = "value",
fun.aggregate = sum
) %>% as.data.frame(.)
dim(Ftable)
dim(Ftable2)
names(Ftable2)
names(Ftable)
head(Ftable )
str(Ftable )
str(Ftable2)
Ftable2 <- FMI %>%
select(vehicle, week, var, type, tier, value) %>%
pivot_wider(names_from = c(var, type, tier),
values_from = value,
values_fn = function(x) sum(x, na.rm = TRUE)) %>%
as.data.frame()
str(Ftable2)
Ftable2 <- FMI %>%
select(vehicle, week, var, type, tier, value) %>%
pivot_wider(names_from = c(var, type, tier),
values_from = value,
values_fn = function(x) sum(x, na.rm = TRUE),
values_fill = 0) %>%
as.data.frame()
Ftable2
str(Ftable2 )
str(Ftable)
identical(Ftable, Ftable2)
sort(Ftable)
names(Ftable)
sort(names(Ftable))
sort(names(Ftable2))
Ftable2[,sort(names(Ftable2))]
Ftable[,sort(names(Ftable2))]
Ftable[,sort(names(Ftable))]
identical(Ftable[,sort(names(Ftable))],Ftable[,sort(names(Ftable))])
identical(Ftable[,sort(names(Ftable))],Ftable2[,sort(names(Ftable))])
identical(Ftable[,sort(names(Ftable))],Ftable2[,sort(names(Ftable2))])
summary(Ftable)
summary(Ftable2)
?identical
all.equal(Ftable[,sort(names(Ftable))],Ftable2[,sort(names(Ftable2))])
Ftable$addressabletv_direct_t1
Ftable2$addressabletv_direct_t1
head(Ftable)
head(Ftable2)
Ftable[,sort(names(Ftable))]
arrange(Ftable[,sort(names(Ftable))], week)
arrange(Ftable[,sort(names(Ftable))], vehicle, week)
arrange(Ftable2[,sort(names(Ftable2))], vehicle, week)
identical(arrange(Ftable2[,sort(names(Ftable2))], vehicle, week), arrange(Ftable[,sort(names(Ftable))], vehicle, week))
library(mmmactive)
devtools::document()
devtools::document()
library(mmmactive)
?mmmactive
browseVignettes(package = "mmmactive"
)
purrr::map()
library(mmmactive)
?mmmactive
browseVignettes(package = "mmmactive")
devtools::install(build_vignettes = TRUE)
browseVignettes(package = "mmmactive")
?if_else
?dcast
devtools::document()
?model.matrix
?separate
library(tidyverse)
?separate
?vif
??vif
?full_join
?durbinWatsonTest
??durbinWatsonTest
shrinker
?shrinker
??shrinker
?funs
?rownames_to_column
devtools::document()
?spread
?lag
?as.formula
?‘:=’
??`:=`
?embed
?as.formula
?lag
myPoly
?rollmean
?cpt.meanvar
??cpt.meanvar
?complete.cases
?incremental_contributions
??incremental_contributions
styler:::style_active_file()
library(mmmactive)
devtools::document()
?embed
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
library(mmmactive)
nmp <- "ttn"
rgn <- c("CR", "MAR", "MTN", "MWR", "NER", "NWR", "SER", "WR")
input_file_ModelSetup =  here::here("data","ttn-ModelSetup.csv")
input_file_ModelSpec = here::here("data","ttn-ModelSpec.csv")
input_file_ModelData = here::here("data","ModelData.xlsx")
input_file_FMIData = here::here("data","FMI.csv")
input_file_MSRPData <- here::here("data","MSRPData.csv")
input_file_SpendData <- here::here("data","SpendData.csv")
input_FitCurves <- here::here("data","Fit_Curves.xlsx")
input_files = list(
input_file_ModelData = input_file_ModelData,
input_file_FMIData = input_file_FMIData,
input_file_SpendData = input_file_SpendData,
input_file_MSRPData = input_file_MSRPData
)
mod_obj <- create_mod_obj()
mod_obj <- activate_model_setup(mod_obj, input_file_ModelSetup)
mod_obj <- activate_model_spec(mod_obj, input_file_ModelSpec)
mod_obj <- add_group_selector(mod_obj, vehicles = nmp, regions = rgn)
mod_obj <- Load_Data(mod_obj, input_files)
mod_obj <- Load_FitCurves(mod_obj, input_FitCurves)
mod_obj <- Transform(mod_obj, print = FALSE)
is.data_transformed(mod_obj)
?set_colnames
?sym
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
library(mmmactive)
nmp <- "ttn"
rgn <- c("CR", "MAR", "MTN", "MWR", "NER", "NWR", "SER", "WR")
input_file_ModelSetup =  here::here("data","ttn-ModelSetup.csv")
input_file_ModelSpec = here::here("data","ttn-ModelSpec.csv")
input_file_ModelData = here::here("data","ModelData.xlsx")
input_file_FMIData = here::here("data","FMI.csv")
input_file_MSRPData <- here::here("data","MSRPData.csv")
input_file_SpendData <- here::here("data","SpendData.csv")
input_FitCurves <- here::here("data","Fit_Curves.xlsx")
input_files = list(
input_file_ModelData = input_file_ModelData,
input_file_FMIData = input_file_FMIData,
input_file_SpendData = input_file_SpendData,
input_file_MSRPData = input_file_MSRPData
)
Add_Dummy <- function(mod_obj) {
cs <- mod_obj$cs
ts <- mod_obj$Time
n_cols_before <- ncol(mod_obj$data)
mod_obj$data <-
mod_obj$data %>%
dplyr::mutate(
DUM_2017_11_01 = if_else(!!rlang::sym(ts) == "2017-11-01", 1, 0),
DUM_2018_01_01 = if_else(!!rlang::sym(ts) == "2018-01-01", 1, 0),
DUM_2017_05_01 = if_else(!!rlang::sym(ts) == "2017-05-01", 1, 0),
DUM_2018_03_01 = if_else(!!rlang::sym(ts) == "2018-03-01", 1, 0),
DUM_2018_09_01 = if_else(!!rlang::sym(ts) == "2018-09-01", 1, 0)
)
n_added_cols <- ncol(mod_obj$data) - n_cols_before
n_cols_after <- ncol(mod_obj$data)
added_dummy_cols <- names(mod_obj$data)[(n_cols_after - (n_added_cols - 1)):n_cols_after]
dummy_spec <-
data.frame(added_dummy_cols, added_dummy_cols, "Base", "Dummy", 1, "None", 0, 1) %>%
magrittr::set_colnames(names(mod_obj$spec)[c(1:6, 17:18)])
mod_obj$spec <-
dplyr::bind_rows(mod_obj$spec, dummy_spec)
return(mod_obj)
}
mod_obj <- create_mod_obj()
mod_obj <- activate_model_setup(mod_obj, input_file_ModelSetup)
mod_obj <- activate_model_spec(mod_obj, input_file_ModelSpec)
mod_obj <- add_group_selector(mod_obj, vehicles = nmp, regions = rgn)
mod_obj <- Load_Data(mod_obj, input_files)
mod_obj <- Load_FitCurves(mod_obj, input_FitCurves)
mod_obj <- Transform(mod_obj, print = FALSE)
mod_obj <- Set_Date_Range(mod_obj)
mod_obj <- Add_Dummy(mod_obj)
mod_obj <- Run_Model_Panel(mod_obj)
is.modeled(mod_obj)
?mmm_load_submodels
frammme::mmm_load_submodels
?mmm_load_submodel
frammme::mmm_load_submodel
devtools::document()
devtools::install(build_vignettes = TRUE)
devtools::install(build_vignettes = TRUE)
?if_else
library(mmmactive)
library(mmmactive)
?mmmactive
browseVignettes(package = "mmmactive")
browseVignettes(package = "mmmactive")
devtools::install(build_vignettes = TRUE)
browseVignettes(package = "mmmactive")
?vignette
vignette("Transform_vignette", "mmmactive")
vignette("LoadData_vignette", "mmmactive")
vignette("Load_Data_vignette", "mmmactive")
vignette("LoadingData_vignette", "mmmactive")
vignette("Modeling_vignette", "mmmactive")
vignette("mod_obj_class_vignette", "mmmactive")
devtools::document()
library(mmmactive)
browseVignettes(package = "mmmactive")
devtools::install(build_vignettes = TRUE)
browseVignettes(package = "mmmactive")
browseVignettes(package = "mmmactive")
